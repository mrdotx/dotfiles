# path:       /home/klassiker/.config/i3/config
# author:     klassiker [mrdotx]
# github:     https://github.com/mrdotx/dotfiles
# date:       2020-05-28T12:53:02+0200

# general config
################

# i3 config file (v4)
set $sup Mod4
set $alt Mod1
set $main eDP1
set $hdmi HDMI2
set $res 1280 768
set $gapsi 4
set $gapso -2

# colors
set_from_resource $black i3wm.color0 #000000
set_from_resource $blackb i3wm.color8 #333333
set_from_resource $red i3wm.color1 #df2800
set_from_resource $redb i3wm.color9 #ff5555
set_from_resource $green i3wm.color2 #00b200
set_from_resource $greenb i3wm.color10 #39ff14
set_from_resource $yellow i3wm.color3 #b0b200
set_from_resource $yellowb i3wm.color11 #effd5f
set_from_resource $blue i3wm.color4 #1f5393
set_from_resource $blueb i3wm.color12 #4185d7
set_from_resource $purple i3wm.color5 #980096
set_from_resource $purpleb i3wm.color13 #ff6fff
set_from_resource $cyan i3wm.color6 #008081
set_from_resource $cyanb i3wm.color14 #7ef9ff
set_from_resource $white i3wm.color7 #cccccc
set_from_resource $whiteb i3wm.color15 #ffffff

# class                 border   backgr.  text     indi.    child
client.focused          $blueb   $blue    $whiteb  $whiteb  $blueb
client.focused_inactive $blackb  $blackb  $whiteb  $blackb  $blackb
client.unfocused        $blackb  $black   $blackb  $blackb  $black
client.urgent           $blackb  $redb    $whiteb  $redb    $redb
client.placeholder      $black   $blackb  $whiteb  $black   $blackb
client.background       $whiteb

floating_modifier $sup
focus_follows_mouse no
mouse_warping none
font pango:DejaVu Sans 10
default_border pixel 2
default_floating_border normal
workspace_auto_back_and_forth yes
# for_window [urgent=latest] focus
gaps inner $gapsi
gaps outer $gapso
smart_gaps on
smart_borders on

# application windows
#####################

# floating applications
for_window [title="cmus" instance="st"] floating enable, sticky enable, move scratchpad, scratchpad show, resize set $res, move position center
for_window [title="floating" instance="st"] floating enable, resize set $res, move position center
for_window [title="alsamixer" instance="st"] floating enable, move position center
for_window [title="calculator" instance="st"] floating enable, resize set $res, move position center
for_window [title="network manager" instance="st"] floating enable, resize set $res, move position center
for_window [title="cdw" instance="st"] floating enable, resize set $res, move position center
for_window [title="File Transfer*"] floating enable, move position center
for_window [title="stopwatch floating"] floating enable, resize set 250 500, move position center

for_window [class="Arandr"] floating enable, sticky enable, resize set $res, move position center
for_window [class="Polkit-gnome-authentication-agent-1"] floating enable, sticky enable, border pixel 2, move position center
for_window [class="Dragon-drag-and-drop"] floating enable, sticky enable, border pixel 2, move position center
for_window [class="Lxappearance"] floating enable, sticky enable, move position center
for_window [class="qt5ct"] floating enable, sticky enable, move position center
for_window [class="Qtconfig-qt4"] floating enable, sticky enable, move position center
for_window [class="Manjaro-hello"] floating enable, border pixel 2, move position center
for_window [class="Pamac-manager"] floating enable, border pixel 2, move position center
for_window [class="Nm-connection-editor"] floating enable, move position center
for_window [class="GParted"] floating enable, move position center
for_window [class="Manjaro Settings Manager"] floating enable, move position center
for_window [class="gmic_qt"] floating enable, move position center
for_window [class="qv4l2"] floating enable
for_window [class="mpv"] sticky enable

# fullscreen applications
for_window [class="Kodi"] fullscreen

# workspace
###########

# workspace names
set $ws1 1
set $ws2 2
set $ws3 3
set $ws4 4
set $ws5 5
set $ws6 6
set $ws7 7
set $ws8 8
set $ws9 9
set $ws10 10

# workspace output
workspace $ws1 output $main $hdmi
workspace $ws2 output $hdmi $main
workspace $ws3 output $main $hdmi
workspace $ws4 output $hdmi $main
workspace $ws5 output $main $hdmi
workspace $ws6 output $hdmi $main
workspace $ws7 output $main $hdmi
workspace $ws8 output $hdmi $main
workspace $ws9 output $main $hdmi
workspace $ws10 output $hdmi $main

# open applications on specific workspaces (xprop)
# assign [title="newsboat" instance="st"] $ws2
assign [class="VirtualBox"] $ws3
assign [class="Brave-browser"] $ws4
assign [title="GIMP Startup"] $ws5
assign [class="Gimp"] $ws5
assign [class="Thunderbird"] $ws6
assign [class="Inkscape"] $ws7
assign [class="scribus"] $ws7
assign [class="Darktable"] $ws7
assign [title="LibreOffice"] $ws8
assign [class="libreoffice"] $ws8
assign [class="Jameica"] $ws9
assign [class="Kodi"] $ws10

# keybindings system managment
##############################

# start program launcher
bindsym Super_L --release exec --no-startup-id "dmenu_run"
bindsym Shift+Super_L --release exec --no-startup-id "rofi -m -1 -show"

# kill focused window
bindsym Ctrl+q kill

# x window kill
bindsym Ctrl+$alt+BackSpace --release exec --no-startup-id "xkill"

# toggle fullscreen mode for the focused container or global
bindsym $sup+f fullscreen toggle
bindsym $sup+Shift+f fullscreen toggle global

# Lock screen or suspend (sleep -> https://github.com/i3/i3/issues/3298)
bindsym $sup+l exec --no-startup-id "sleep 0.5 && i3_knockout.sh -lock simple"
bindsym $sup+Shift+l exec --no-startup-id "sleep 0.5 && i3_knockout.sh -suspend"

# restart i3 inplace (preserves your layout/session, can be used to upgrade i3)
bindsym $sup+Shift+r restart

# exit i3 (logs you out of your x session)
bindsym Ctrl+$alt+Delete exec "i3-nagbar -t warning -m 'You pressed the exit shortcut. Do you really want to exit i3? This will end your X session.' -b 'Yes, exit i3' 'i3-msg exit'"
bindsym $sup+Shift+q exec --no-startup-id "i3-msg exit"

# xautolock disable/enable
bindsym $sup+Shift+a exec --no-startup-id "if [ \\"$(systemctl --user is-active xautolock.service)\\" = \\"active\\" ]; then systemctl --user disable xautolock.service --now && notify-send 'xautolock' 'stopped and disabled'; else systemctl --user enable xautolock.service --now && notify-send 'xautolock' 'enabled and started'; fi"

# xbanish disable/enable
bindsym $sup+Shift+b exec --no-startup-id "if [ \\"$(systemctl --user is-active xbanish.service)\\" = \\"active\\" ]; then systemctl --user disable xbanish.service --now && notify-send 'xbanish' 'stopped and disabled'; else systemctl --user enable xbanish.service --now && notify-send 'xbanish' 'enabled and started'; fi"

# dunst restart
bindsym $sup+Shift+d exec --no-startup-id "killall dunst; notify-send 'i3' 'restart dunst'"

# picom disable/enable
bindsym $sup+Shift+p exec --no-startup-id "if [ \\"$(systemctl --user is-active picom.service)\\" = \\"active\\" ]; then systemctl --user disable picom.service --now && notify-send 'picom' 'stopped and disabled'; else systemctl --user enable picom.service --now && notify-send 'picom' 'enabled and started'; fi"

# polybar switch layout and disable/enable
bindsym $sup+y exec --no-startup-id "polybar.sh -t"
bindsym $sup+Shift+y exec --no-startup-id "if [ \\"$(systemctl --user is-active polybar.service)\\" = \\"active\\" ]; then systemctl --user disable polybar.service --now && notify-send 'polybar' 'stopped and disabled'; else systemctl --user enable polybar.service --now && notify-send 'polybar' 'enabled and started'; fi"

# keybindings windows/container
###############################

# window switcher
bindsym $sup+Tab exec --no-startup-id "dmenu_windows.sh"

# split orientation
bindsym $sup+Ctrl+Up exec --no-startup-id "if [ -n \\"$(pgrep -x i3_tiling.sh)\\" ]; then pkill -x i3_tiling.sh && notify-send 'i3' 'optimal tiling off'; else  i3_tiling.sh & notify-send 'i3' 'optimal tiling on'; fi"
bindsym $sup+Ctrl+Down split toggle; exec --no-startup-id "notify-send 'i3' 'tile container direction toggled'"

# change focus
bindsym $sup+Left focus left
bindsym $sup+Right focus right
bindsym $sup+Up focus up
bindsym $sup+Down focus down

# move focused window
bindsym $sup+Shift+Left move left 20 px
bindsym $sup+Shift+Right move right 20 px
bindsym $sup+Shift+Up move up 20 px
bindsym $sup+Shift+Down move down 20 px

# resize window
bindsym $sup+$alt+Left resize shrink width 20 px or 4 ppt
bindsym $sup+$alt+Right resize grow width 20 px or 4 ppt
bindsym $sup+$alt+Up resize shrink height 20 px or 4 ppt
bindsym $sup+$alt+Down resize grow height 20 px or 4 ppt

# resize gaps
bindsym $sup+shift+minus gaps outer current minus 4, gaps inner current minus 8
bindsym $sup+shift+equal gaps outer current plus 4, gaps inner current plus 8
bindsym $sup+equal gaps inner current set $gapsi, gaps outer current set $gapso

# toggle sticky
bindsym $sup+space sticky toggle

# change focus between tiling/floating windows
bindsym $sup+bracketleft focus mode_toggle

# toggle tiling/floating
bindsym $sup+bracketright floating toggle

# Show the next scratchpad window or hide the focused scratchpad window.
# If there are multiple scratchpad windows, this command cycles through them.
bindsym $sup+shift+bracketleft scratchpad show

# move the currently focused window to the scratchpad
bindsym $sup+shift+bracketright move scratchpad

# keybindings workspaces
########################

# switch to workspace
bindsym $sup+1 workspace $ws1
bindsym $sup+2 workspace $ws2
bindsym $sup+3 workspace $ws3
bindsym $sup+4 workspace $ws4
bindsym $sup+5 workspace $ws5
bindsym $sup+6 workspace $ws6
bindsym $sup+7 workspace $ws7
bindsym $sup+8 workspace $ws8
bindsym $sup+9 workspace $ws9
bindsym $sup+0 workspace $ws10

# move focused container to workspace
bindsym $sup+Ctrl+1 move container to workspace $ws1
bindsym $sup+Ctrl+2 move container to workspace $ws2
bindsym $sup+Ctrl+3 move container to workspace $ws3
bindsym $sup+Ctrl+4 move container to workspace $ws4
bindsym $sup+Ctrl+5 move container to workspace $ws5
bindsym $sup+Ctrl+6 move container to workspace $ws6
bindsym $sup+Ctrl+7 move container to workspace $ws7
bindsym $sup+Ctrl+8 move container to workspace $ws8
bindsym $sup+Ctrl+9 move container to workspace $ws9
bindsym $sup+Ctrl+0 move container to workspace $ws10

# move to workspace with focused container
bindsym $sup+Shift+1 move container to workspace $ws1; workspace $ws1
bindsym $sup+Shift+2 move container to workspace $ws2; workspace $ws2
bindsym $sup+Shift+3 move container to workspace $ws3; workspace $ws3
bindsym $sup+Shift+4 move container to workspace $ws4; workspace $ws4
bindsym $sup+Shift+5 move container to workspace $ws5; workspace $ws5
bindsym $sup+Shift+6 move container to workspace $ws6; workspace $ws6
bindsym $sup+Shift+7 move container to workspace $ws7; workspace $ws7
bindsym $sup+Shift+8 move container to workspace $ws8; workspace $ws8
bindsym $sup+Shift+9 move container to workspace $ws9; workspace $ws9
bindsym $sup+Shift+0 move container to workspace $ws10; workspace $ws10

# workspace back and forth
bindsym $alt+Tab workspace back_and_forth

# navigate workspaces next/previous
bindsym $sup+Ctrl+Left workspace prev
bindsym $sup+Ctrl+Right workspace next

# keybindings xf86 keys
#######################

bindsym XF86AudioRaiseVolume exec --no-startup-id "audio.sh -inc 5"
bindsym XF86AudioLowerVolume exec --no-startup-id "audio.sh -dec 5"
bindsym XF86AudioMute exec --no-startup-id "audio.sh -mute"
bindsym XF86MonBrightnessUp exec --no-startup-id "xbacklight -time 200 -steps 10 -inc 5"
bindsym XF86MonBrightnessDown exec --no-startup-id "xbacklight -time 200 -steps 10 -dec 5"
bindsym XF86Cut exec --no-startup-id "xsel.sh"
bindsym $sup+p exec --no-startup-id "dmenu_display.sh"

# keybindings screenshot
########################

bindsym Print --release exec --no-startup-id "screenshot.sh -desk"
bindsym $sup+Print --release exec --no-startup-id "screenshot.sh -window"
bindsym $sup+Shift+Print --release exec --no-startup-id "screenshot.sh -select"

# keybindings applications
##########################

bindsym $sup+Return exec --no-startup-id "$TERMINAL"
# bindsym $sup+Shift+Return exec --no-startup-id "urxvtc.sh"
bindsym $sup+Shift+Return exec --no-startup-id "urxvt"

bindsym $sup+a exec --no-startup-id "$TERMINAL -e alsamixer"
bindsym $sup+b exec --no-startup-id "dmenu_bookmarks.sh"
bindsym $sup+c exec --no-startup-id "$TERMINAL -e cmus.sh"
bindsym $sup+Shift+c exec --no-startup-id "cmus_notify.sh --notify-send"
bindsym $sup+d exec "darktable"
bindsym $sup+e exec --no-startup-id "dmenu_vim.sh"
bindsym $sup+g exec "gimp"
bindsym $sup+h exec --no-startup-id "$TERMINAL -e htop"
bindsym $sup+i exec "inkscape"
bindsym $sup+j exec "jameica"
bindsym $sup+k exec --no-startup-id "sync_keepass.sh && keepassxc && sync_keepass.sh"
bindsym $sup+m exec "thunderbird"
bindsym $sup+n exec --no-startup-id "polybar-msg hook module/rss 4 > /dev/null 2>&1 && $TERMINAL -e newsboat -q && polybar-msg hook module/rss 1 > /dev/null 2>&1"
bindsym $sup+o exec "libreoffice"
bindsym $sup+r exec --no-startup-id "$TERMINAL -e $FILE"
bindsym $sup+s exec "scribus"
bindsym $sup+u exec --no-startup-id "dmenu_mount.sh"
bindsym $sup+v exec --no-startup-id "dmenu_virtualbox.sh"
bindsym $sup+w exec --no-startup-id "brave"
bindsym $sup+Shift+w exec --no-startup-id "$BROWSER"
bindsym $sup+x exec --no-startup-id "link_handler.sh $(dragon-drag-and-drop -t -x)"
bindsym $sup+z exec --no-startup-id "filezilla"

bindsym $sup+backslash exec --no-startup-id "dmenu_calc.sh"
bindsym $sup+grave exec --no-startup-id "dmenu_unicode_symbols.sh"
bindsym $sup+comma exec --no-startup-id "sleep 0.5 && chameleon.sh"
bindsym $sup+period exec --no-startup-id "$TERMINAL -T 'stopwatch floating' -e stopwatch.sh"
bindsym $sup+slash exec --no-startup-id "$BROWSER $HOME/Dokumente/Notes/html/shortcuts.html"
bindsym $sup+Shift+slash exec --no-startup-id "$BROWSER $HOME/Dokumente/Notes/html/index.html"

bindsym $sup+F1 exec --no-startup-id "conky.sh vertical"

# i3 status bar
###############

# bar {
#     id bar-0
#     position top
#     height 27
#     status_command i3status --config ~/.config/i3status/config_pmon
#     i3bar_command i3bar --transparency
#     output eDP1
#     tray_output eDP1
#     tray_padding 2
#     font pango:DejaVu Sans 10
#     separator_symbol " "
#     colors {
#         background #00000000
#         statusline $whiteb
#         separator  $white

#         focused_workspace  $blue   $blueb  $whiteb
#         active_workspace   $whiteb $blackb $whiteb
#         inactive_workspace $blackb $black  $white
#         urgent_workspace   $blackb $redb   $whiteb
#         binding_mode       $blackb $redb   $whiteb
#     }
# }

# bar {
#     id bar-1
#     position top
#     height 27
#     status_command i3status --config ~/.config/i3status/config_smon
#     i3bar_command i3bar --transparency
#     output HDMI2
#     tray_output none
#     tray_padding 2
#     font pango:DejaVu Sans 10
#     separator_symbol " "
#     colors {
#         background #00000000
#         statusline $whiteb
#         separator  $white

#         focused_workspace  $blue   $blueb  $whiteb
#         active_workspace   $whiteb $blackb $whiteb
#         inactive_workspace $blackb $black  $white
#         urgent_workspace   $blackb $redb   $whiteb
#         binding_mode       $blackb $redb   $whiteb
#     }
# }

# start systemd target
######################

exec --no-startup-id "systemctl --user start window-manager.target"
exec --no-startup-id "sleep 3 && i3_tiling.sh"
